\connect analytics_dev;

CREATE SCHEMA raw;
CREATE SCHEMA dw;

CREATE TABLE raw.generalledger (
    id              bigserial PRIMARY KEY,
    company_code    varchar(10)      NOT NULL,
    account_no      varchar(20)      NOT NULL,
    project_code    varchar(50),
    posting_date    date             NOT NULL,
    amount          numeric(18,2)    NOT NULL,
    voucher_no      varchar(50),
    created_at      timestamptz      NOT NULL DEFAULT now()
);

INSERT INTO raw.generalledger
    (company_code, account_no, project_code, posting_date, amount, voucher_no)
VALUES
    -- 2023: Company C100, Project P100
    ('C100', '3000', 'P100', DATE '2023-01-15',  150000.00, 'V2023-0001'),
    ('C100', '4000', 'P100', DATE '2023-01-15',  -85000.00, 'V2023-0002'),
    ('C100', '5000', 'P100', DATE '2023-01-31',  -30000.00, 'V2023-0003'),
    ('C100', '7000', 'P100', DATE '2023-01-31',  -10000.00, 'V2023-0004'),

    ('C100', '3000', 'P100', DATE '2023-02-15',  175000.00, 'V2023-0005'),
    ('C100', '4000', 'P100', DATE '2023-02-15',  -95000.00, 'V2023-0006'),
    ('C100', '5000', 'P100', DATE '2023-02-28',  -32000.00, 'V2023-0007'),
    ('C100', '7000', 'P100', DATE '2023-02-28',  -10000.00, 'V2023-0008'),

    -- 2023: Company C200, Project P200
    ('C200', '3000', 'P200', DATE '2023-03-15',  200000.00, 'V2023-0101'),
    ('C200', '3010', 'P200', DATE '2023-03-15',   50000.00, 'V2023-0102'),
    ('C200', '4000', 'P200', DATE '2023-03-15', -130000.00, 'V2023-0103'),
    ('C200', '5000', 'P200', DATE '2023-03-31',  -40000.00, 'V2023-0104'),
    ('C200', '7000', 'P200', DATE '2023-03-31',  -15000.00, 'V2023-0105'),

    -- 2024: Company C100, Project P100
    ('C100', '3000', 'P100', DATE '2024-01-15',  180000.00, 'V2024-0001'),
    ('C100', '4000', 'P100', DATE '2024-01-15', -100000.00, 'V2024-0002'),
    ('C100', '5000', 'P100', DATE '2024-01-31',  -35000.00, 'V2024-0003'),
    ('C100', '7000', 'P100', DATE '2024-01-31',  -12000.00, 'V2024-0004'),

    -- 2024: Company C200, Project P300
    ('C200', '3000', 'P300', DATE '2024-06-15',  220000.00, 'V2024-0101'),
    ('C200', '3010', 'P300', DATE '2024-06-15',   60000.00, 'V2024-0102'),
    ('C200', '4000', 'P300', DATE '2024-06-15', -150000.00, 'V2024-0103'),
    ('C200', '5000', 'P300', DATE '2024-06-30',  -45000.00, 'V2024-0104'),
    ('C200', '7000', 'P300', DATE '2024-06-30',  -18000.00, 'V2024-0105');
